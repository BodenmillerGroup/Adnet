# adnet/bpR2 analysis

This repository contains the analysis scripts used for the paper:
"Influence of node abundance on signaling network state and dynamics analyzed by mass cytometry"
Xiao-Kang Lun, Vito RT Zanotelli, James D Wade, Denis Schapiro, Marco Tognetti1, Nadine Dobberstein & Bernd Bodenmiller

# Installation:
The package can be installed using the python package manager pip. Using a virtual environment is highly recommended.

1) clone the github repsitory:
git clone https://github.com/BodenmillerGroup/Adnet.git

2) install it with:
pip install -e ./Adnet

# Analysis workflow:
The analysis consists of a main workflow which is configured using a '.ini' configuration file and the data organized in
a specific folder structure. Ipython notebooks are used for the downstream analysis and further visualization of the
results.

## File structure requirements:
The overall folder structure should be as follows:

- Experiment:
    a folder corresponding to one cyTOF experiment, that can contain multiple barcoding plates.
    - AcquisitionA:
        a folder corresponding to an cyTOF acquisition barcoding plate. Contains:
        - xx_barcode_key.csv:
            A csv file with the metadata, see example for exact structure:
                row, column, marker, perturbation, timepoint, replicate

        - gated: a folder containing the data
            - xy_rowcolumn_xy.fcs: fcs files with '_' seperated fields in the name and the rowcolumn information.


    - AcquisitionB
        ...

- name_dict.csv:
    a comma seperated files with 2 columns:
        old, new
        old: column name as used in the .fcs file
        new: renamed column name as should be used in the analysis plots. Non ASCII characters can give problems.

- config.ini:
    a configuration file with all the parameters used for the analysis. Please look at the specifications in the example
    file 'example/config_documentation.ini'

## Run analysis

After installation of the package (above) the analysis can be run as follows:

python -m adnet.adnet_analysis /pathto/config.ini

## Output

Depending on the settings of the config.ini file, the following output will be generated:

outfolder: folder defined in the config.ini
    - config.ini: a copy of the config.ini used for the analysis

    - bin_dat: a pandas pickle file containing the summary statistics generated by the analysis.
                Can be loaded as pandas.read_pickle("bin_dat")

    - complete_dat: a pandas pickle file containing the single cell data used by the analysis.
                Can be loaded as pandas.read_pickle("complete_dat")

    - Cutoff.pdf: the histogram showing the cutoff in relation to the negative controls

    - Plots as png, pdf: plots are strongly depending on the configuration specified in the file.

















































